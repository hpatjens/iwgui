<html>
    <style>
        button {
            display: block;
        }

        .row {
            display: flex;
        }

        .column {
            flex: 50%;
        }
    </style>
    <script>
        let to_browser_socket = new WebSocket("ws://localhost:9001")
        let to_server_socket = new WebSocket("ws://localhost:9001")
        let uuid = #uuid

        to_browser_socket.onopen = function(e) {
            // Send the welcome message to the server to register this websocket as the one responsible for the server-browser connection
            to_browser_socket.send(JSON.stringify({
                "Welcome":{
                    "direction":"ToBrowser",
                    "uuid":uuid
                }
            }))
        }
        to_browser_socket.onmessage = function(event) {
            //console.log(`[message] Data received from server: ${event.data}`)
            //document.body.innerHTML = event.data

            var server_browser_update = JSON.parse(event.data)
            for (const added in server_browser_update.added) {
                console.log(`${added} -> ${JSON.stringify(server_browser_update.added[added])}`)
            }


        }
        to_browser_socket.onclose = function(event) {
            if (event.wasClean) {
                console.log(`[close] Connection closed cleanly, code=${event.code} reason=${event.reason}`)
            } else {
                console.log('[close] Connection died')
            }
        }
        to_browser_socket.onerror = function(error) {
            console.log(`[error] ${error.message}`)
        }


        
        to_server_socket.onopen = function(e) {
            // Send the welcome message to the server to register this websocket as the one responsible for the browser-server connection
            to_server_socket.send(JSON.stringify({
                "Welcome":{
                    "direction":"ToServer",
                    "uuid":uuid
                }
            }))
        }
        to_server_socket.onmessage = function(event) {
            console.log("[Error] onmessage called on to_server_socket")
        }
        to_server_socket.onclose = function(event) {
            if (event.wasClean) {
                console.log(`[close] Connection closed cleanly, code=${event.code} reason=${event.reason}`)
            } else {
                console.log('[close] Connection died')
            }
        }
        to_server_socket.onerror = function(error) {
            console.log(`[error] ${error.message}`)
        }





        function send_event(event) {
            var event = JSON.stringify(event)
            to_server_socket.send(event)
            console.log("Sent event: " + event)
        }
    </script>
    <body>
        
    </body>
</html>